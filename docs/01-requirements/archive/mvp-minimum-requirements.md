# 🚀 MVP最小限要件定義書

**作成日**: 2025年7月6日  
**バージョン**: v1.0  
**ステータス**: ドラフト

## 📋 概要

このドキュメントは、モンスター収集型ゲーム学習プロジェクトの最初のリリース（MVP）における最小限の実装範囲を定義します。「小さくリリースして機能を追加していく」アプローチに基づき、学習者が最短で達成感を得られる最小構成を定めます。

## 🎯 MVP目標

### 主要目標
1. **動くゲームを最速でリリース** - 学習者が実際に遊べるものを提供
2. **基本的な学習要素を網羅** - フロントエンド・バックエンド・DB連携の基礎を体験
3. **拡張可能な基盤を構築** - 今後の機能追加が容易な設計

### 達成指標
- プレイヤーがブラウザでゲームを開始できる
- 基本的なゲームループが動作する
- 初学者が理解できるシンプルなコード構成

## 🔧 技術スコープ（最小限）

### フロントエンド
- **React + TypeScript** の基本的な使用
- **Grid Layout** によるシンプルなUI配置
- **キーボード入力** の処理
- **APIとの通信** （fetch/async-await）

### バックエンド  
- **Hono** による基本的なREST API
- **Cloudflare Workers** へのデプロイ
- **エラーハンドリング** の基礎

### データベース
- **Cloudflare D1** の基本的な使用
- **シンプルなテーブル設計** （正規化は最小限）
- **基本的なCRUD操作**

## 📱 最小限MVP機能要件

### 1. ゲーム開始機能
- **プレイヤー作成**
  - 名前入力のみ（その他のカスタマイズは後回し）
  - 初期モンスター1体を自動付与
- **ゲーム画面への遷移**

### 2. マップ表示・移動
- **単一マップのみ** （10x10グリッド程度）
- **プレイヤーの現在位置表示**
- **矢印キーでの移動** （上下左右）
- **マップ端での移動制限**

### 3. モンスターエンカウント
- **特定マスでのみ出現** （草むらエリア3-5箇所）
- **固定確率** （移動時30%程度）
- **1種類のモンスターのみ** 出現

### 4. 超簡易バトル
- **1対1のみ**
- **技は1つのみ** （たいあたり固定）
- **HP表示とダメージ計算**
- **勝敗判定** （どちらかのHPが0になったら終了）
- **逃げる機能**

### 5. モンスター捕獲
- **キャプチャーボール1種類のみ**
- **固定確率** （50%）で捕獲成功
- **所持モンスターリスト** に追加

## 🚫 MVPでは実装しない機能

以下の機能は学習コンテンツとして後から追加：

1. **複数マップ・マップ遷移**
2. **NPC・イベント・会話**
3. **複数の技・タイプ相性**
4. **レベルアップ・進化**
5. **アイテムシステム全般**
6. **セーブ/ロード機能**
7. **パーティ編成・モンスター入れ替え**
8. **状態異常・特殊効果**
9. **音楽・効果音**
10. **アニメーション効果**

## 📊 データ設計（最小限）

### 必要なテーブル（3つのみ）

#### 1. players（プレイヤー）
```sql
CREATE TABLE players (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  x INTEGER DEFAULT 5,
  y INTEGER DEFAULT 5,
  created_at TEXT DEFAULT CURRENT_TIMESTAMP
);
```

#### 2. pokemons（所持モンスター）
```sql
CREATE TABLE pokemons (
  id TEXT PRIMARY KEY,
  player_id TEXT NOT NULL,
  name TEXT NOT NULL,
  hp INTEGER DEFAULT 20,
  max_hp INTEGER DEFAULT 20,
  created_at TEXT DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (player_id) REFERENCES players(id)
);
```

#### 3. battles（バトル記録）
```sql
CREATE TABLE battles (
  id TEXT PRIMARY KEY,
  player_id TEXT NOT NULL,
  result TEXT NOT NULL, -- 'win', 'lose', 'escape'
  created_at TEXT DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (player_id) REFERENCES players(id)
);
```

## 🔌 API設計（最小限）

### 必要なエンドポイント（5つのみ）

1. **POST /api/players** - プレイヤー作成
2. **GET /api/players/:id** - プレイヤー情報取得
3. **PUT /api/players/:id/move** - プレイヤー移動
4. **POST /api/battles** - バトル開始
5. **POST /api/pokemons** - モンスター捕獲

## 🎨 UI設計（最小限）

### 必要な画面（3つのみ）

1. **スタート画面**
   - タイトル表示
   - 名前入力フォーム
   - ゲーム開始ボタン

2. **マップ画面**
   - 10x10のグリッド表示
   - プレイヤー位置（●で表示）
   - 草むらエリア（緑色で表示）
   - 現在地座標表示

3. **バトル画面**
   - 敵モンスターのHP表示
   - 自分のモンスターのHP表示
   - アクションボタン（たたかう・つかまえる・にげる）
   - 結果メッセージ表示エリア

## 📝 実装優先順位

### Phase 1（1週間目）
1. プロジェクトセットアップ
2. 基本的なルーティング
3. スタート画面とプレイヤー作成API
4. データベーステーブル作成

### Phase 2（2週間目）
1. マップ画面の表示
2. キーボード移動の実装
3. プレイヤー移動API
4. エンカウント判定

### Phase 3（3週間目）
1. バトル画面の作成
2. バトルロジックの実装
3. 捕獲機能の実装
4. 基本的なエラーハンドリング

### Phase 4（4週間目）
1. 統合テスト
2. デプロイ設定
3. 動作確認・バグ修正
4. ドキュメント整理

## 🚀 リリース基準

### 必須条件
- [ ] ローカル環境で全機能が動作
- [ ] Cloudflareにデプロイ済み
- [ ] 基本的なエラーが発生しない
- [ ] 最低限のテストが通る

### 推奨条件
- [ ] レスポンシブ対応（PC・タブレット）
- [ ] 基本的な入力バリデーション
- [ ] ローディング表示

## 💡 初学者向けの配慮

### コード品質
- 過度な抽象化を避ける
- 1ファイル1機能を心がける
- 日本語でのコメントを充実させる
- 変数名・関数名を分かりやすく

### 学習ステップ
1. **最初は動くことを優先** - 完璧を求めない
2. **段階的なリファクタリング** - 後から改善
3. **エラーから学ぶ** - エラーメッセージを丁寧に

## 📌 注意事項

### やらないこと
- 最初から完璧を目指さない
- 複雑な状態管理を導入しない
- 過度な最適化をしない
- 将来の拡張を考えすぎない

### 重要な原則
- **KISS原則** - Keep It Simple, Stupid
- **YAGNI原則** - You Ain't Gonna Need It
- **動くものを早く** - 完璧より進捗

## 🔄 次のステップ

MVP完成後、以下の順で機能追加を検討：

1. 複数マップとマップ遷移
2. 複数のモンスター種類
3. レベルアップシステム
4. アイテムシステム
5. セーブ/ロード機能

各機能は独立した学習コンテンツとして、初学者が段階的に実装できるよう設計する。